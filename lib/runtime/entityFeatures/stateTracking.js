"use strict";

require("source-map-support/register");

const Rules = require('../../enum/Rules');

const Generators = require('../Generators');

module.exports = {
  [Rules.RULE_AFTER_VALIDATION]: ({
    feature,
    entityModel,
    context
  }, next) => {
    feature.forEach(featureItem => {
      if (featureItem.field in context.latest) {
        let targetState = context.latest[featureItem.field];
        let timestampFieldName = featureItem.stateMapping[targetState];
        context.latest[timestampFieldName] = Generators.default(entityModel.meta.fields[timestampFieldName], context.i18n);
      }
    });
    return next();
  }
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9ydW50aW1lL2VudGl0eUZlYXR1cmVzL3N0YXRlVHJhY2tpbmcuanMiXSwibmFtZXMiOlsiUnVsZXMiLCJyZXF1aXJlIiwiR2VuZXJhdG9ycyIsIm1vZHVsZSIsImV4cG9ydHMiLCJSVUxFX0FGVEVSX1ZBTElEQVRJT04iLCJmZWF0dXJlIiwiZW50aXR5TW9kZWwiLCJjb250ZXh0IiwibmV4dCIsImZvckVhY2giLCJmZWF0dXJlSXRlbSIsImZpZWxkIiwibGF0ZXN0IiwidGFyZ2V0U3RhdGUiLCJ0aW1lc3RhbXBGaWVsZE5hbWUiLCJzdGF0ZU1hcHBpbmciLCJkZWZhdWx0IiwibWV0YSIsImZpZWxkcyIsImkxOG4iXSwibWFwcGluZ3MiOiJBQUFBOzs7O0FBRUEsTUFBTUEsS0FBSyxHQUFHQyxPQUFPLENBQUMsa0JBQUQsQ0FBckI7O0FBQ0EsTUFBTUMsVUFBVSxHQUFHRCxPQUFPLENBQUMsZUFBRCxDQUExQjs7QUFPQUUsTUFBTSxDQUFDQyxPQUFQLEdBQWlCO0FBQ2IsR0FBQ0osS0FBSyxDQUFDSyxxQkFBUCxHQUErQixDQUFDO0FBQUVDLElBQUFBLE9BQUY7QUFBV0MsSUFBQUEsV0FBWDtBQUF3QkMsSUFBQUE7QUFBeEIsR0FBRCxFQUFvQ0MsSUFBcEMsS0FBNkM7QUFDeEVILElBQUFBLE9BQU8sQ0FBQ0ksT0FBUixDQUFnQkMsV0FBVyxJQUFJO0FBQzNCLFVBQUlBLFdBQVcsQ0FBQ0MsS0FBWixJQUFxQkosT0FBTyxDQUFDSyxNQUFqQyxFQUF5QztBQUNyQyxZQUFJQyxXQUFXLEdBQUdOLE9BQU8sQ0FBQ0ssTUFBUixDQUFlRixXQUFXLENBQUNDLEtBQTNCLENBQWxCO0FBQ0EsWUFBSUcsa0JBQWtCLEdBQUdKLFdBQVcsQ0FBQ0ssWUFBWixDQUF5QkYsV0FBekIsQ0FBekI7QUFDQU4sUUFBQUEsT0FBTyxDQUFDSyxNQUFSLENBQWVFLGtCQUFmLElBQXFDYixVQUFVLENBQUNlLE9BQVgsQ0FBbUJWLFdBQVcsQ0FBQ1csSUFBWixDQUFpQkMsTUFBakIsQ0FBd0JKLGtCQUF4QixDQUFuQixFQUFnRVAsT0FBTyxDQUFDWSxJQUF4RSxDQUFyQztBQUNIO0FBQ0osS0FORDtBQVFBLFdBQU9YLElBQUksRUFBWDtBQUNIO0FBWFksQ0FBakIiLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcblxuY29uc3QgUnVsZXMgPSByZXF1aXJlKCcuLi8uLi9lbnVtL1J1bGVzJyk7XG5jb25zdCBHZW5lcmF0b3JzID0gcmVxdWlyZSgnLi4vR2VuZXJhdG9ycycpO1xuXG4vKipcbiAqIEEgcnVsZSBzcGVjaWZpZXMgdGhlIGNoYW5nZSBvZiBzdGF0ZSB3aWxsIGJlIHRyYWNrZWQgYXV0b21hdGljYWxseS5cbiAqIEBtb2R1bGUgRW50aXR5RmVhdHVyZVJ1bnRpbWVfU3RhdGVUcmFja2luZ1xuICovXG5cbm1vZHVsZS5leHBvcnRzID0ge1xuICAgIFtSdWxlcy5SVUxFX0FGVEVSX1ZBTElEQVRJT05dOiAoeyBmZWF0dXJlLCBlbnRpdHlNb2RlbCwgY29udGV4dCB9LCBuZXh0KSA9PiB7XG4gICAgICAgIGZlYXR1cmUuZm9yRWFjaChmZWF0dXJlSXRlbSA9PiB7XG4gICAgICAgICAgICBpZiAoZmVhdHVyZUl0ZW0uZmllbGQgaW4gY29udGV4dC5sYXRlc3QpIHtcbiAgICAgICAgICAgICAgICBsZXQgdGFyZ2V0U3RhdGUgPSBjb250ZXh0LmxhdGVzdFtmZWF0dXJlSXRlbS5maWVsZF07XG4gICAgICAgICAgICAgICAgbGV0IHRpbWVzdGFtcEZpZWxkTmFtZSA9IGZlYXR1cmVJdGVtLnN0YXRlTWFwcGluZ1t0YXJnZXRTdGF0ZV07XG4gICAgICAgICAgICAgICAgY29udGV4dC5sYXRlc3RbdGltZXN0YW1wRmllbGROYW1lXSA9IEdlbmVyYXRvcnMuZGVmYXVsdChlbnRpdHlNb2RlbC5tZXRhLmZpZWxkc1t0aW1lc3RhbXBGaWVsZE5hbWVdLCBjb250ZXh0LmkxOG4pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTsgICAgICAgIFxuXG4gICAgICAgIHJldHVybiBuZXh0KCk7XG4gICAgfVxufTsiXX0=