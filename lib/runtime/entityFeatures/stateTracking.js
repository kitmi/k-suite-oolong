"use strict";

require("source-map-support/register");

const Rules = require('../../enum/Rules');

const Generators = require('../Generators');

module.exports = {
  [Rules.RULE_AFTER_VALIDATION]: (feature, entityModel, context) => {
    feature.forEach(featureItem => {
      if (featureItem.field in context.latest) {
        let targetState = context.latest[featureItem.field];
        let timestampFieldName = featureItem.stateMapping[targetState];
        context.latest[timestampFieldName] = Generators.default(entityModel.meta.fields[timestampFieldName], context.i18n);
      }
    });
    return true;
  }
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9ydW50aW1lL2VudGl0eUZlYXR1cmVzL3N0YXRlVHJhY2tpbmcuanMiXSwibmFtZXMiOlsiUnVsZXMiLCJyZXF1aXJlIiwiR2VuZXJhdG9ycyIsIm1vZHVsZSIsImV4cG9ydHMiLCJSVUxFX0FGVEVSX1ZBTElEQVRJT04iLCJmZWF0dXJlIiwiZW50aXR5TW9kZWwiLCJjb250ZXh0IiwiZm9yRWFjaCIsImZlYXR1cmVJdGVtIiwiZmllbGQiLCJsYXRlc3QiLCJ0YXJnZXRTdGF0ZSIsInRpbWVzdGFtcEZpZWxkTmFtZSIsInN0YXRlTWFwcGluZyIsImRlZmF1bHQiLCJtZXRhIiwiZmllbGRzIiwiaTE4biJdLCJtYXBwaW5ncyI6IkFBQUE7Ozs7QUFFQSxNQUFNQSxLQUFLLEdBQUdDLE9BQU8sQ0FBQyxrQkFBRCxDQUFyQjs7QUFDQSxNQUFNQyxVQUFVLEdBQUdELE9BQU8sQ0FBQyxlQUFELENBQTFCOztBQU9BRSxNQUFNLENBQUNDLE9BQVAsR0FBaUI7QUFDYixHQUFDSixLQUFLLENBQUNLLHFCQUFQLEdBQStCLENBQUNDLE9BQUQsRUFBVUMsV0FBVixFQUF1QkMsT0FBdkIsS0FBbUM7QUFDOURGLElBQUFBLE9BQU8sQ0FBQ0csT0FBUixDQUFnQkMsV0FBVyxJQUFJO0FBQzNCLFVBQUlBLFdBQVcsQ0FBQ0MsS0FBWixJQUFxQkgsT0FBTyxDQUFDSSxNQUFqQyxFQUF5QztBQUNyQyxZQUFJQyxXQUFXLEdBQUdMLE9BQU8sQ0FBQ0ksTUFBUixDQUFlRixXQUFXLENBQUNDLEtBQTNCLENBQWxCO0FBQ0EsWUFBSUcsa0JBQWtCLEdBQUdKLFdBQVcsQ0FBQ0ssWUFBWixDQUF5QkYsV0FBekIsQ0FBekI7QUFDQUwsUUFBQUEsT0FBTyxDQUFDSSxNQUFSLENBQWVFLGtCQUFmLElBQXFDWixVQUFVLENBQUNjLE9BQVgsQ0FBbUJULFdBQVcsQ0FBQ1UsSUFBWixDQUFpQkMsTUFBakIsQ0FBd0JKLGtCQUF4QixDQUFuQixFQUFnRU4sT0FBTyxDQUFDVyxJQUF4RSxDQUFyQztBQUNIO0FBQ0osS0FORDtBQVFBLFdBQU8sSUFBUDtBQUNIO0FBWFksQ0FBakIiLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcblxuY29uc3QgUnVsZXMgPSByZXF1aXJlKCcuLi8uLi9lbnVtL1J1bGVzJyk7XG5jb25zdCBHZW5lcmF0b3JzID0gcmVxdWlyZSgnLi4vR2VuZXJhdG9ycycpO1xuXG4vKipcbiAqIEEgcnVsZSBzcGVjaWZpZXMgdGhlIGNoYW5nZSBvZiBzdGF0ZSB3aWxsIGJlIHRyYWNrZWQgYXV0b21hdGljYWxseS5cbiAqIEBtb2R1bGUgRW50aXR5RmVhdHVyZVJ1bnRpbWVfU3RhdGVUcmFja2luZ1xuICovXG5cbm1vZHVsZS5leHBvcnRzID0ge1xuICAgIFtSdWxlcy5SVUxFX0FGVEVSX1ZBTElEQVRJT05dOiAoZmVhdHVyZSwgZW50aXR5TW9kZWwsIGNvbnRleHQpID0+IHtcbiAgICAgICAgZmVhdHVyZS5mb3JFYWNoKGZlYXR1cmVJdGVtID0+IHtcbiAgICAgICAgICAgIGlmIChmZWF0dXJlSXRlbS5maWVsZCBpbiBjb250ZXh0LmxhdGVzdCkge1xuICAgICAgICAgICAgICAgIGxldCB0YXJnZXRTdGF0ZSA9IGNvbnRleHQubGF0ZXN0W2ZlYXR1cmVJdGVtLmZpZWxkXTtcbiAgICAgICAgICAgICAgICBsZXQgdGltZXN0YW1wRmllbGROYW1lID0gZmVhdHVyZUl0ZW0uc3RhdGVNYXBwaW5nW3RhcmdldFN0YXRlXTtcbiAgICAgICAgICAgICAgICBjb250ZXh0LmxhdGVzdFt0aW1lc3RhbXBGaWVsZE5hbWVdID0gR2VuZXJhdG9ycy5kZWZhdWx0KGVudGl0eU1vZGVsLm1ldGEuZmllbGRzW3RpbWVzdGFtcEZpZWxkTmFtZV0sIGNvbnRleHQuaTE4bik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pOyAgICAgICAgXG5cbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxufTsiXX0=