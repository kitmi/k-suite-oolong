"use strict";

require("source-map-support/register");

const Rules = require('../../enum/Rules');

module.exports = {
  [Rules.RULE_BEFORE_FIND]: ({
    feature,
    entityModel,
    context
  }, next) => {
    let findOptions = context.findOptions;

    if (!findOptions.$includeDeleted) {
      findOptions.$where = entityModel.mergeCondition(findOptions.$where, {
        [feature.field]: {
          $ne: feature.value
        }
      });
    }

    return next();
  }
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9ydW50aW1lL2VudGl0eUZlYXR1cmVzL2xvZ2ljYWxEZWxldGlvbi5qcyJdLCJuYW1lcyI6WyJSdWxlcyIsInJlcXVpcmUiLCJtb2R1bGUiLCJleHBvcnRzIiwiUlVMRV9CRUZPUkVfRklORCIsImZlYXR1cmUiLCJlbnRpdHlNb2RlbCIsImNvbnRleHQiLCJuZXh0IiwiZmluZE9wdGlvbnMiLCIkaW5jbHVkZURlbGV0ZWQiLCIkd2hlcmUiLCJtZXJnZUNvbmRpdGlvbiIsImZpZWxkIiwiJG5lIiwidmFsdWUiXSwibWFwcGluZ3MiOiJBQUFBOzs7O0FBRUEsTUFBTUEsS0FBSyxHQUFHQyxPQUFPLENBQUMsa0JBQUQsQ0FBckI7O0FBT0FDLE1BQU0sQ0FBQ0MsT0FBUCxHQUFpQjtBQUNiLEdBQUNILEtBQUssQ0FBQ0ksZ0JBQVAsR0FBMEIsQ0FBQztBQUFFQyxJQUFBQSxPQUFGO0FBQVdDLElBQUFBLFdBQVg7QUFBd0JDLElBQUFBO0FBQXhCLEdBQUQsRUFBb0NDLElBQXBDLEtBQTZDO0FBQ25FLFFBQUlDLFdBQVcsR0FBR0YsT0FBTyxDQUFDRSxXQUExQjs7QUFDQSxRQUFJLENBQUNBLFdBQVcsQ0FBQ0MsZUFBakIsRUFBa0M7QUFDOUJELE1BQUFBLFdBQVcsQ0FBQ0UsTUFBWixHQUFxQkwsV0FBVyxDQUFDTSxjQUFaLENBQTJCSCxXQUFXLENBQUNFLE1BQXZDLEVBQStDO0FBQUUsU0FBQ04sT0FBTyxDQUFDUSxLQUFULEdBQWlCO0FBQUVDLFVBQUFBLEdBQUcsRUFBRVQsT0FBTyxDQUFDVTtBQUFmO0FBQW5CLE9BQS9DLENBQXJCO0FBQ0g7O0FBRUQsV0FBT1AsSUFBSSxFQUFYO0FBQ0g7QUFSWSxDQUFqQiIsInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xuXG5jb25zdCBSdWxlcyA9IHJlcXVpcmUoJy4uLy4uL2VudW0vUnVsZXMnKTtcblxuLyoqXG4gKiBBIHJ1bGUgc3BlY2lmaWVzIHRoZSBlbnRpdHkgd2lsbCBub3QgYmUgZGVsZXRlZCBwaHlzaWNhbGx5LlxuICogQG1vZHVsZSBFbnRpdHlGZWF0dXJlUnVudGltZV9Mb2dpY2FsRGVsZXRpb25cbiAqL1xuXG5tb2R1bGUuZXhwb3J0cyA9IHtcbiAgICBbUnVsZXMuUlVMRV9CRUZPUkVfRklORF06ICh7IGZlYXR1cmUsIGVudGl0eU1vZGVsLCBjb250ZXh0IH0sIG5leHQpID0+IHtcbiAgICAgICAgbGV0IGZpbmRPcHRpb25zID0gY29udGV4dC5maW5kT3B0aW9ucztcbiAgICAgICAgaWYgKCFmaW5kT3B0aW9ucy4kaW5jbHVkZURlbGV0ZWQpIHtcbiAgICAgICAgICAgIGZpbmRPcHRpb25zLiR3aGVyZSA9IGVudGl0eU1vZGVsLm1lcmdlQ29uZGl0aW9uKGZpbmRPcHRpb25zLiR3aGVyZSwgeyBbZmVhdHVyZS5maWVsZF06IHsgJG5lOiBmZWF0dXJlLnZhbHVlIH0gfSk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gbmV4dCgpO1xuICAgIH1cbn07Il19