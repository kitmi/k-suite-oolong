"use strict";

require("source-map-support/register");

const Rules = require('../../enum/Rules');

const {
  mergeCondition
} = require('../../utils/lang');

module.exports = {
  [Rules.RULE_BEFORE_FIND]: ({
    feature,
    entityModel,
    context
  }, next) => {
    let findOptions = context.findOptions;

    if (!findOptions.$includeDeleted) {
      findOptions.$query = mergeCondition(findOptions.$query, {
        [feature.field]: {
          $ne: feature.value
        }
      });
    }

    return next();
  }
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9ydW50aW1lL2VudGl0eUZlYXR1cmVzL2xvZ2ljYWxEZWxldGlvbi5qcyJdLCJuYW1lcyI6WyJSdWxlcyIsInJlcXVpcmUiLCJtZXJnZUNvbmRpdGlvbiIsIm1vZHVsZSIsImV4cG9ydHMiLCJSVUxFX0JFRk9SRV9GSU5EIiwiZmVhdHVyZSIsImVudGl0eU1vZGVsIiwiY29udGV4dCIsIm5leHQiLCJmaW5kT3B0aW9ucyIsIiRpbmNsdWRlRGVsZXRlZCIsIiRxdWVyeSIsImZpZWxkIiwiJG5lIiwidmFsdWUiXSwibWFwcGluZ3MiOiJBQUFBOzs7O0FBRUEsTUFBTUEsS0FBSyxHQUFHQyxPQUFPLENBQUMsa0JBQUQsQ0FBckI7O0FBQ0EsTUFBTTtBQUFFQyxFQUFBQTtBQUFGLElBQXFCRCxPQUFPLENBQUMsa0JBQUQsQ0FBbEM7O0FBT0FFLE1BQU0sQ0FBQ0MsT0FBUCxHQUFpQjtBQUNiLEdBQUNKLEtBQUssQ0FBQ0ssZ0JBQVAsR0FBMEIsQ0FBQztBQUFFQyxJQUFBQSxPQUFGO0FBQVdDLElBQUFBLFdBQVg7QUFBd0JDLElBQUFBO0FBQXhCLEdBQUQsRUFBb0NDLElBQXBDLEtBQTZDO0FBQ25FLFFBQUlDLFdBQVcsR0FBR0YsT0FBTyxDQUFDRSxXQUExQjs7QUFDQSxRQUFJLENBQUNBLFdBQVcsQ0FBQ0MsZUFBakIsRUFBa0M7QUFDOUJELE1BQUFBLFdBQVcsQ0FBQ0UsTUFBWixHQUFxQlYsY0FBYyxDQUFDUSxXQUFXLENBQUNFLE1BQWIsRUFBcUI7QUFBRSxTQUFDTixPQUFPLENBQUNPLEtBQVQsR0FBaUI7QUFBRUMsVUFBQUEsR0FBRyxFQUFFUixPQUFPLENBQUNTO0FBQWY7QUFBbkIsT0FBckIsQ0FBbkM7QUFDSDs7QUFFRCxXQUFPTixJQUFJLEVBQVg7QUFDSDtBQVJZLENBQWpCIiwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XG5cbmNvbnN0IFJ1bGVzID0gcmVxdWlyZSgnLi4vLi4vZW51bS9SdWxlcycpO1xuY29uc3QgeyBtZXJnZUNvbmRpdGlvbiB9ID0gcmVxdWlyZSgnLi4vLi4vdXRpbHMvbGFuZycpO1xuXG4vKipcbiAqIEEgcnVsZSBzcGVjaWZpZXMgdGhlIGVudGl0eSB3aWxsIG5vdCBiZSBkZWxldGVkIHBoeXNpY2FsbHkuXG4gKiBAbW9kdWxlIEVudGl0eUZlYXR1cmVSdW50aW1lX0xvZ2ljYWxEZWxldGlvblxuICovXG5cbm1vZHVsZS5leHBvcnRzID0ge1xuICAgIFtSdWxlcy5SVUxFX0JFRk9SRV9GSU5EXTogKHsgZmVhdHVyZSwgZW50aXR5TW9kZWwsIGNvbnRleHQgfSwgbmV4dCkgPT4ge1xuICAgICAgICBsZXQgZmluZE9wdGlvbnMgPSBjb250ZXh0LmZpbmRPcHRpb25zO1xuICAgICAgICBpZiAoIWZpbmRPcHRpb25zLiRpbmNsdWRlRGVsZXRlZCkge1xuICAgICAgICAgICAgZmluZE9wdGlvbnMuJHF1ZXJ5ID0gbWVyZ2VDb25kaXRpb24oZmluZE9wdGlvbnMuJHF1ZXJ5LCB7IFtmZWF0dXJlLmZpZWxkXTogeyAkbmU6IGZlYXR1cmUudmFsdWUgfSB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBuZXh0KCk7XG4gICAgfVxufTsiXX0=