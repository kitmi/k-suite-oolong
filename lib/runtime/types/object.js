"use strict";

require("source-map-support/register");

const _ = require('rk-utils')._;

const {
  isNothing
} = require('../../utils/lang');

const any = require('./any');

module.exports = {
  name: 'object',
  alias: ['json'],
  sanitize: (value, info, i18n) => {
    if (_.isPlainObject(value)) return value;
    if (_.isObjectLike(value)) return _.toPlainObject(value);

    if (typeof value === 'string') {
      let trimmed = value.trim();

      if (trimmed.startsWith('{') && trimmed.endsWith('}')) {
        return JSON.parse(trimmed);
      }
    }

    return value;
  },
  defaultValue: {},
  generate: (info, i18n) => null,
  serialize: value => isNothing(value) ? null : JSON.stringify(value),
  qualifiers: any.qualifiers.concat([])
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9ydW50aW1lL3R5cGVzL29iamVjdC5qcyJdLCJuYW1lcyI6WyJfIiwicmVxdWlyZSIsImlzTm90aGluZyIsImFueSIsIm1vZHVsZSIsImV4cG9ydHMiLCJuYW1lIiwiYWxpYXMiLCJzYW5pdGl6ZSIsInZhbHVlIiwiaW5mbyIsImkxOG4iLCJpc1BsYWluT2JqZWN0IiwiaXNPYmplY3RMaWtlIiwidG9QbGFpbk9iamVjdCIsInRyaW1tZWQiLCJ0cmltIiwic3RhcnRzV2l0aCIsImVuZHNXaXRoIiwiSlNPTiIsInBhcnNlIiwiZGVmYXVsdFZhbHVlIiwiZ2VuZXJhdGUiLCJzZXJpYWxpemUiLCJzdHJpbmdpZnkiLCJxdWFsaWZpZXJzIiwiY29uY2F0Il0sIm1hcHBpbmdzIjoiQUFBQTs7OztBQUVBLE1BQU1BLENBQUMsR0FBR0MsT0FBTyxDQUFDLFVBQUQsQ0FBUCxDQUFvQkQsQ0FBOUI7O0FBQ0EsTUFBTTtBQUFFRSxFQUFBQTtBQUFGLElBQWdCRCxPQUFPLENBQUMsa0JBQUQsQ0FBN0I7O0FBQ0EsTUFBTUUsR0FBRyxHQUFHRixPQUFPLENBQUMsT0FBRCxDQUFuQjs7QUFFQUcsTUFBTSxDQUFDQyxPQUFQLEdBQWlCO0FBQ2JDLEVBQUFBLElBQUksRUFBRSxRQURPO0FBR2JDLEVBQUFBLEtBQUssRUFBRSxDQUFFLE1BQUYsQ0FITTtBQUtiQyxFQUFBQSxRQUFRLEVBQUUsQ0FBQ0MsS0FBRCxFQUFRQyxJQUFSLEVBQWNDLElBQWQsS0FBdUI7QUFDN0IsUUFBSVgsQ0FBQyxDQUFDWSxhQUFGLENBQWdCSCxLQUFoQixDQUFKLEVBQTRCLE9BQU9BLEtBQVA7QUFFNUIsUUFBSVQsQ0FBQyxDQUFDYSxZQUFGLENBQWVKLEtBQWYsQ0FBSixFQUEyQixPQUFPVCxDQUFDLENBQUNjLGFBQUYsQ0FBZ0JMLEtBQWhCLENBQVA7O0FBRTNCLFFBQUksT0FBT0EsS0FBUCxLQUFpQixRQUFyQixFQUErQjtBQUMzQixVQUFJTSxPQUFPLEdBQUdOLEtBQUssQ0FBQ08sSUFBTixFQUFkOztBQUNBLFVBQUlELE9BQU8sQ0FBQ0UsVUFBUixDQUFtQixHQUFuQixLQUEyQkYsT0FBTyxDQUFDRyxRQUFSLENBQWlCLEdBQWpCLENBQS9CLEVBQXNEO0FBQ2xELGVBQU9DLElBQUksQ0FBQ0MsS0FBTCxDQUFXTCxPQUFYLENBQVA7QUFDSDtBQUNKOztBQUVELFdBQU9OLEtBQVA7QUFDSCxHQWxCWTtBQW9CYlksRUFBQUEsWUFBWSxFQUFFLEVBcEJEO0FBc0JiQyxFQUFBQSxRQUFRLEVBQUUsQ0FBQ1osSUFBRCxFQUFPQyxJQUFQLEtBQWdCLElBdEJiO0FBd0JiWSxFQUFBQSxTQUFTLEVBQUdkLEtBQUQsSUFBV1AsU0FBUyxDQUFDTyxLQUFELENBQVQsR0FBbUIsSUFBbkIsR0FBMEJVLElBQUksQ0FBQ0ssU0FBTCxDQUFlZixLQUFmLENBeEJuQztBQTBCYmdCLEVBQUFBLFVBQVUsRUFBRXRCLEdBQUcsQ0FBQ3NCLFVBQUosQ0FBZUMsTUFBZixDQUFzQixFQUF0QjtBQTFCQyxDQUFqQiIsInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xuXG5jb25zdCBfID0gcmVxdWlyZSgncmstdXRpbHMnKS5fO1xuY29uc3QgeyBpc05vdGhpbmcgfSA9IHJlcXVpcmUoJy4uLy4uL3V0aWxzL2xhbmcnKTtcbmNvbnN0IGFueSA9IHJlcXVpcmUoJy4vYW55Jyk7XG5cbm1vZHVsZS5leHBvcnRzID0ge1xuICAgIG5hbWU6ICdvYmplY3QnLFxuXG4gICAgYWxpYXM6IFsgJ2pzb24nIF0sXG5cbiAgICBzYW5pdGl6ZTogKHZhbHVlLCBpbmZvLCBpMThuKSA9PiB7XG4gICAgICAgIGlmIChfLmlzUGxhaW5PYmplY3QodmFsdWUpKSByZXR1cm4gdmFsdWU7XG5cbiAgICAgICAgaWYgKF8uaXNPYmplY3RMaWtlKHZhbHVlKSkgcmV0dXJuIF8udG9QbGFpbk9iamVjdCh2YWx1ZSk7XG5cbiAgICAgICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgIGxldCB0cmltbWVkID0gdmFsdWUudHJpbSgpO1xuICAgICAgICAgICAgaWYgKHRyaW1tZWQuc3RhcnRzV2l0aCgneycpICYmIHRyaW1tZWQuZW5kc1dpdGgoJ30nKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBKU09OLnBhcnNlKHRyaW1tZWQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHZhbHVlO1xuICAgIH0sXG5cbiAgICBkZWZhdWx0VmFsdWU6IHt9LFxuXG4gICAgZ2VuZXJhdGU6IChpbmZvLCBpMThuKSA9PiBudWxsLFxuXG4gICAgc2VyaWFsaXplOiAodmFsdWUpID0+IGlzTm90aGluZyh2YWx1ZSkgPyBudWxsIDogSlNPTi5zdHJpbmdpZnkodmFsdWUpLFxuXG4gICAgcXVhbGlmaWVyczogYW55LnF1YWxpZmllcnMuY29uY2F0KFtcbiAgICBdKVxufTsiXX0=